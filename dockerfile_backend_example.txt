FROM node:18-alpine

WORKDIR /app

# Copy package.json from the server directory
# Note: The build context is the project root, so we access server/package.json
COPY server/package.json ./

RUN npm install

# Copy the rest of the server code
COPY server/ .

# Create directories for uploads and processed files
RUN mkdir -p uploads processed

EXPOSE 3000

CMD ["node", "index.js"]